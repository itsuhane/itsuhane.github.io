---
layout: post
title: "简单粗暴的旋转小量"
date: 2017-01-02 09:01:10 GMT
tags:
- Lie groups
- rotation
- algebra
comment: true
---

在 SLAM 问题中通常含有姿态变量，上一篇文章中我们举了一个旋转作为变量的例子。在文章里我们还引入了一些晦涩的东西，比如流形、切空间、Lie 群……

不过我们有一种简单粗暴的方法来理解旋转和旋转群。要想说明这一切，我们还是先回到数学中引入群的动机。

群的发明是为了能够研究各种各样的对称现象。以镜面（镜像变换）为例，我们将一个右撇子放在镜子前，镜子里出现的就是一个左撇子，反过来类似。不过我们关心的并不是左撇子还是右撇子，我们关心镜像变换这个现象本身。我们还知道镜像的镜像就等于什么都没有变——不管你最初拿来的是苹果还是梨都一样。

那么，如果将 { 不变, 镜像 } 作为一个集合，并且把一个操作（不妨叫乘法）用来表示这个集合里的元素按照先后顺序进行变换操作，我们就知道

> 不变 x 不变 = 不变
>
> 不变 x 镜像 = 镜像
>
> 镜像 x 不变 = 镜像
>
> 镜像 x 镜像 = 不变

进一步地，我们还发现对于集合里任意选取的三个元素 A B C ，它们之间的操作总是满足

> (A x B) x C = A x (B x C)

这样，对于集合里的元素，我们就发现了四个有趣的现象：

1. 有一个单位元素 E （不变），它与任何元素 X 先后进行变换都得到那个元素 X 。
2. 对于任何元素 X ，有一个元素 inv(X) ，它与 X 先后进行变换总得到 E ，并且 inv(E) = E 。
3. 对于任意两个元素 X 和 Y，它们先后进行变换后总得到这个集合里的一个已知的变换。
4. 对于任意三个元素 X Y Z ，它们按照某个顺序变换时，结合的顺序不影响结果。

这四个现象对于广泛的对称现象都是适用的，于是我们把满足这四个现象的集合以及对应的乘法放在一起，叫做一个群。

一个集合的全体置换操作便构成一个群，一般叫置换群。对于一个方程来讲，它的全部根可以相互置换而不影响方程的诸多性质，这个根的置换群就叫 Abel 群。计算机里使用的有限位数的二进制整数对加法封闭，而当加法产生溢出时则会关于一个上界求余后折回，这全体可表示的二进制整数关于加法构成了一个同余加法群……我们有各种各样的群。

不过上面我们举例子的这些群都有个特点：它们的元素都是离散的元素。离散元素的群使得很多如导数、积分等等的分析工具失效。而 Lie 群是一类特殊的群，这类群都是连续（光滑）的，因此我们可以用微积分工具进行研究。

旋转群就是一个 Lie 群，很容易可以验证旋转群的集合满足上面的四个条件。但同时我们可以看到一个与一个旋转可以任意接近地存在无数多其它的旋转。这便是旋转群连续的一个感性认识。旋转群的连续加上旋转这个操作本身的特点，使得这个群有了特殊的几何结构——我们可以把零旋转附近的连续结构通过旋转放置到这个群内任何一个元素的附近，从而得到对这个元素附近的连续结构的描述——而这就是 Lie 群的一个思想。当我们想要研究两个距离比较远的元素时，不妨考虑这两个元素之间的一条连续的路径，我们可以沿着这个路径，用一个个局部的操作来一点点从一个元素逼近到另一个元素——这是 Lie 群的连续性带给我们的好处，当然这个代价也是很大的，其中一个例子便是 Lie 群和它伴随的 Lie 代数上的 BCH 公式。

这里我们不去讨论这些技术细节，因为一旦展开，我们就要面临大量晦涩难懂的数学定义和公式。但我们仅从上面的这个“对称”的认识来理解旋转小量的叠加。

我们的思路很简单：1. 看看零旋转附近；2. 想办法把零旋转附近的结构放置到任意旋转处。

对于第一件事，在最小二乘问题（九）中我们提到了 $\lfloor dr \times \rfloor$ 的小增量。既然是增量，把它加上 $I$，我们就得到了零旋转附近的旋转增量表示 $(\lfloor dr \times \rfloor + I)$ 。对于第二件事，如果我们想把这个结构放到旋转 $R$ 的位置，最简单的方式就是把它用 $R$ 旋转一下！

因此我们就得到了在那篇文章中提到的小旋转的扰动模型 $R\oplus dr = (\lfloor dr \times \rfloor + I) R$。

当然有人会问为什么不把 $R$ 左乘？这是个 convention 的问题，当然不同的 convention 背后对应了不同（相似）的理论推导。

希望上面的这些介绍能够让你对这个结论有一个直观的感性认识，并且方便你在相关问题中直接记忆住结论。但如果你想深入探究它背后的规则，还是要认真进行一番推导的。这里推荐 Timothy Barfoot 的著作 State Estimation for Robotics [^1]。

[^1]: State Estimation for Robotics - A Matrix Lie Group Approach, Barfoot, T. D., 2016 ([online](http://asrl.utias.utoronto.ca/~tdb/bib/barfoot_ser15.pdf)).
