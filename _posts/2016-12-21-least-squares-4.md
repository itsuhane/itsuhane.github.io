---
layout: post
title: "最小二乘问题（四）"
date: 2016-12-21 09:00:43 GMT
tags:
- least squares
comment: true
---

前面我们发现各种类型的线性最小二乘最后都可以变成一个最朴素的标准型。那么接下来是不是该讲怎么解标准型最小二乘问题了呢？很遗憾我们不会介绍怎么求解最小二乘问题。

为什么？前面我们提到了，使最小二乘问题最优的解，就是它的标准方程的解。也就是说，我们应该转而研究如何求解线性方程。这就在本系列话题之外了，会另外开辟内容介绍。

今天我们介绍最小二乘问题的概率背景，即最大似然估计（MLE）。

首先解释什么叫最大似然估计。白话说就是：这么多事儿里头就这个最容易发生，那就是这个了。概率上讲就是求使得概率 $P(x)$ 最大的 $x$ 。还有一个比较突出重点的解释，就是最大似然估计是求解随机分布中的众数（mode）。

设 $r\equiv Ax-b$ ，一般我们称 $r$ 为残差。这个名字是有来由的，通常我们认为它是个误差项，并且满足均值为零的高斯分布。在很多问题中，我们认为 $r$ 的每一维都是独立同分布的，在这样的条件下，我们知道 $P\left(r\right) \propto \exp-\frac{r^Tr}{2\sigma^2}$ 。

那么最大化上述概率就是：

$$
\arg\max \exp -\frac{r^Tr}{2\sigma^2} = \arg\min \frac{r^Tr}{2\sigma^2} = \arg\min \|r\|^2.
$$

由此可见两者是等价的。

接下来，我们来看一个重要的变形：如果 $r$ 的每一维不是独立同分布的，但都是高斯的。此时 $r$ 符合一个一般的多变量高斯分布。如果设 $r$ 的协方差矩阵为 $\Sigma$ ，那么此时 $r$ 的最大似然估计则是：

$$
\arg\max \exp -r^T\Sigma^{-1}r = \arg\min r^T\Sigma^{-1}r.
$$

如果我们引入 Mahalanobis 距离 $\\|x\\|_P = \sqrt{x^TPx}$ 。令矩阵 $H = \Sigma^{-1}$ ，那么上面的问题可以简写成 $\min \\|r\\|_H^2$ 。

引入这个记法除了简化记号外有啥别的帮助么？范数都变了呀，是不是现在我们终于得到了一个不能写成线性最小二乘标准型的问题呢？

别着急，如果我们设矩阵 $U$ 满足 $U^TU = H$ ，那么我们便知道

$$
\|r\|_H^2 = r^THr = r^TU^TUr = \|Ur\|^2.
$$

怎么样，又回到最小二乘了吧？前面我们介绍过了 Cholesky 分解，因此我们知道当 $H$ 是对称正定矩阵的时候，对应的 $U$ 肯定能找得到。

……那如果不是高斯分布呢？（你闭嘴！
