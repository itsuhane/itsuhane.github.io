---
layout: post
title: "最小二乘问题（九）"
date: 2017-01-01 09:01:03 GMT
tags:
- least squares
comment: true
---

对于函数 $h(x) = 0$ ，如果有向量函数 $f: \mathbb{R}^s \to \\{x\in\mathbb{R}^n \| h(x)=0\\}$ 使得 $h(f(p))=0$ ，并且 $f$ 为满射。那么流形 $h$ 上的最小二乘可以改写为：

$$
\min \|r(f(x))\|^2.
$$

这是我们喜闻乐见一般最小二乘的形式。但是这类向量函数并不总是有理想的性质，比如它们可能会在定义域内存在奇异点。

我们以旋转变换的 Rodrigues 参数化为例，一个在三维空间中绕着轴 $k$ （$\\|k\\|=1$）转动 $\theta$ 的旋转可以用向量 $v = k\theta$ 表示。

在这种参数化表示下，将一个点 $x$ 进行旋转得到 $R(x;v)$ 的变换为：

$$
R(x;v) = x\cos\|v\|+\frac{\sin\|v\|}{\|v\|}v\times x+\frac{1-\cos\|v\|}{\|v\|^2}v^Tx\cdot v.
$$

从表达式可以看出来，$v=0$ 是它的奇异点。在这一点处我们可以通过取极限的方法来延拓它的值和导数。通过 $\lim_{v\to 0}\frac{\partial R(x;v)}{\partial v}$ 来逼近它的导数，可以得到：

$$
\frac{\partial R}{\partial v} = \lfloor x\times \rfloor = \begin{pmatrix}
0 & -x_3 & x_2 \\
x_3 & 0 & -x_1 \\
-x_2 & x_1 & 0
\end{pmatrix}.
$$

但在其它点处……呵呵我就不算了……

这里这个奇异点处的导数形式简单，我们来研究一下如何利用它。

全体三维旋转构成了三维标准正交群 $\mathbb{SO}(3)$ 。群所代表的是对称性质，标准正交群的对称性质非常好：它经过任意的三维旋转仍然得到自己。那么当我们有一个非零的旋转，我们可以先将它旋转到零，然后研究在零点加入旋转小量后的性质，然后再旋转回去（假装成旋转就是在原地发生）。这样，我们就可以使用上面那个零点处的导数。

我们把这个思路包装起来，每次加入的小旋转记作 $dv$，原始的旋转记作 $R$ ，把这个原始的旋转“归零”、“加入小旋转”、“复位”的操作假装成“在旋转上添加小旋转”，用 $R \oplus dv$ 表示。其实（经过了一系列理论推导）它就是：

$$
R\oplus dv = (\lfloor dv \times \rfloor+I) R.
$$

有了这么一个工具，如果优化目标变量里出现了旋转，我们可以把子优化写成下面这样：

$$
\min_{dv} \|r(R\oplus dv)\|^2.
$$

还是加一个小量，对小量做优化，只不过小量不再是传统的加法了。通过这种特殊的加法，我们保证了目标变量依旧属于拥有某个特殊的群。

数学上，我们把这类群叫做李群（Lie Group），而那个加号是从李群导出的李代数上对应的加法。标准正交群 $\mathbb{SO}(n)$，标准欧几里得群 $\mathbb{SE}(n)$ 都是李群，它们都有对应的李代数以及对应的加法。有了这些，当一个变量属于某个已知的李群结构，你可以方便地定义你的加号，然后直接套用到最小二乘中，从而保证解满足结构约束。当然，这套术语也可以拿去吹牛了。

嘛……不过从本质上，它就是我们上一篇介绍的流形上的最小二乘的一类特殊情形。
